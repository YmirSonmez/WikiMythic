4.8.0
=====

 

Major Stuff
-----------

 

### Versions



-   Dropped 1.11 support (why aren't you on 1.12 yet?)



### AI Update



-   Many AI goals/targeters have been improved
-   Performance has been improved
-   A new API has been added for registering custom AI goals



### Villager Trades

 You can now configure villager trades! Please note that villagers
must have certain professions to be able to trade, and some items may
require the villager to be a certain level. 

    MerchantTest:
      Type: VILLAGER
      Display: '&6Merchant Test'
      Health: 20
      Faction: tester 
      Options:
        Profession: NITWIT
        Type: DESERT
        Level: 2
      Trades:
        1:
          Item1: 5 EMERALD
          Item2: 5 DIAMOND
          Result: DIAMOND_SWORD
          MaxUses: 5
        2:
          Item1: 64 EMERALD
          Result: SkeletonKingSword
          MaxUses: 1



### Chain Mechanic

  A really cool new mechanic! See entry in the mechanics section.


Commands
--------



-   Added -p flag to mob spawn command, allowing you to spawn mobs at
    aspecific player



Mobs
----



-   Added WANDERING_TRADER



### Options



-   Added **Options.PreventTransformation: true** to stop zombies from
    turning into pigmen or drowned



Mechanics
---------

 

### NEW: BarCreate



### NEW: BarSet



### NEW: BarRemove



### NEW: BlockWave

 Creates a wave of blocks. This effect is client-side (there is no
risk to your server). {{ :blockwave.gif?400 |}} 

### NEW: BloodyScreen



### NEW: Chain

 This allows you to make skills that bounce between targets, like a
"chain lightning" type skill.  BounceConditions are evaluated after
each "bounce" of the skill. With the example, if someone were on the
other side of a wall from the mob but you were standing in the doorway,
it could bounce from you to them since it bounced around the wall 
It will only bounce to the same entity per cast once. Also every time
the skill bounces, the entity it is bouncing from will be the "origin"
in the skill and the inherited target of onBounce will be the next
entity it is bouncing to, so fromOrigin is your friend for making
effects!  Example:

1.  chain{

<!-- -->

        bounces=5;
        bounceRadius=10;
        bounceDelay=1;
        hitSelf=false;
        hitPlayers=true;
        hitNonPlayers=true;
        hitTarget=true;
        onBounce=[
          - effect:particleline{p=flame;fromOrigin=true}
        ];
        bounceConditions=[
          - inlineofsight
          - hasaura{aura=damageResist} false
        ];
      } @target ~onTimer:20



### NEW: CloseInventory



### NEW: MountMe



### NEW: SendToast



### NEW: Stun

  An aura mechanic that will stun the target entity for its
duration. 

1.  stun{auraName=stunned;d=100;facing=true;onTick=[ -
    particles{p=crit;amount=10;hS=0.4} ]} @trigger ~onInteract



### Cast



-   Added skillName, showCastBar options to cast mechanic
-   The Cast mechanic will show a hologram castbar if showCastBar=true



### Damage



-   Added damageType option, can be set to whatever you want
-   You can use any custom damageTypes you define in DamageModifiers and
    in the onDamaged aura

 Here are some examples of this in action: 

1.  damage{amount=10;element=FIRE} @target ~onUse
2.  damage{amount=10;element=ICE} @target ~onUse



    DamageModTest:
      Type: COW
      DamageModifiers:
      - LIGHTNING 0.1
      - FIRE 2.0
      - AIR 1.0
      - ICE 0.5
      Skills:
      - message{m="Damaged by <skill.var.damage-type> for <skill.var.damage-amount>"} @PIR{r=50} ~onDamaged



### onDamaged



-   Added **damageMods** option, letting you create auras that apply
    damage modifiers.
-   Can also specify custom damageMods that you use in the damage
    mechanic

<!-- -->

    
      - onDamaged{
          auraName=damageResist;d=200;
          onTick=[
            - particles{p=flame;amount=10;hS=0.4}
          ];
          damageMods="FIRE 0.5"} @self ~onInteract



### Particles



-   Added campfire_cosy, campfire_signal particles
-   Allowed a bunch of placeholders in more mechanics



Conditions
----------



### NEW: EnchantExp



### NEW: EnchantLevel



### NEW: FoodSaturation



### NEW: FoodLevel



### NEW: LocalDifficulty

 

Targeters
---------

 

### New Sorters



-   Added new Target sorters 
    -   HIGHEST_HEALTH 
    -   LOWEST_HEALTH 
    -   HIGHEST_THREAT 
    -   LOWEST_THREAT



    @ThreatTablePlayers{sort=HIGHEST_THREAT;limit=5}    
    

### NEW: @RandomLocationsNearTargets

 

AI Goals/Targets
----------------



### NEW: NearestConditionalTarget

 A premium-only AI Targeter that will cause the mob to attack any
nearby entities that meet the supplied conditions.  Example:

    AITargetSelectors:
    - clear
    - nearestConditionalTarget{conditions=[
          - entitytype PLAYER
          - hasaura{aura=marked_for_death}
        ]}



### NEW: FleeConditional

 A premium-only AI Goal that will cause the mob to flee from any
nearby entities that meet the supplied conditions.  Example:

    AIGoalSelectors:
    - clear
    - fleeConditional{distance=5; speed=2; conditions=[
          - inlineofsight
          - entitytype COW
        ]}



Placeholders
------------



-   Added missing trigger.threat placeholder



Compatibility
-------------

 

### LibsDisguises



-   Fixed some disguise bugs



Bug Fixes / Other
-----------------



-   Added better error catching for placeholders
-   Most mob config keys can now be lowercase if desired
-   Removed some outdated methods for determining mob type
-   Fixed ParticleAtom effect on 1.13+
-   Fixed bugs with global variables
-   Fixed some issues with goToOwner AI goal
-   Fixed bug with BlockUnmask effect
-   Fix for BLOCK projectile bullets on pre1.13 versions
-   Fixed inline conditions not working inside of metaskills
-   Fixed variableMath mechanic adding instead of setting values
-   Fixed NPE with target.name placeholder
-   Fixed some compatibility issues with WorldGuard on 1.8
-   Fixed plugin not loading on 1.8.8 PaperSpigot
-   Fixed a mob loading error on 1.8
-   Fixed hasParticles=false in potion mechanic
-   Fixed NPE when creating spawners that use mpets
-   Fixed vault currency reward messages to be rounded to 2 decimal
    places
-   Fixed some issues with bstats
-   Fixed a bunch of broken AI targeters on 1.14
-   Fixed bug with goToOwner AI goal
-   Fixed NPE in rally mechanic
-   Fixed NPE in @MobsInRadius targeter
-   Fixed numerous bugs with auras
-   Fixed projectiles hitting and stopping on non-creatures
-   Fixed projectile mob bullets sometimes getting stuck and not
    despawning
-   Fixed some inconsistencies with ThreatTables
-   Fixed mob sometimes not being marked in combat when targeting
    players
-   Fixed ThreatTable mobs continuing to target players that died
-   Fixed onDropCombat skills sometimes firing twice
-   Fixed sounds playing with infinite range on 1.14
-   Fixed some bugs with the Wearing condition
-   Fixed some bugs with item NBT
-   Fixed some bugs with shootFireball
-   Fixed creeper damage being modified when it shouldn't
-   Fixed some bugs with targeters
-   Fixed some issues with the prison mechanic